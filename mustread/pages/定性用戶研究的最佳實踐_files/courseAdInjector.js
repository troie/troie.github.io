"use strict";define(["jquery","modules/countdown"],function(e,n){function t(n){n=n||{};var t=e.extend({},{nthElementPosition:6,minWordsInElement:60,immediateChildrenOnly:!0,elementType:"P",mixPixelsBetweenTwoAds:Math.max(2*window.screen.height,1e3)},n);return t.elementType=t.elementType.toUpperCase(),t}function i(n,t){var i=e(n+(t.immediateChildrenOnly?">":" ")+t.elementType),s=[];if(i.length<t.nthElementPosition)return s;i.each(function(n,i){if(!(n<t.nthElementPosition)){var o=i.previousElementSibling;if(null!==o&&o.tagName===t.elementType){var l=i.nextElementSibling;if(null!==l&&l.tagName===t.elementType)e(i).text().replace(/(^\s*)|(\s*$)/gi,"").replace(/[ ]{2,}/gi," ").replace(/\n /,"\n").split(" ").length<=t.minWordsInElement||s.push(i)}}});var o=[];return e.each(s,function(e,n){if(e!==s.length+1){var t=s[e+1];n.nextElementSibling===t&&o.push(n)}}),o}return{addCourseAd:function(s,o,l,r){var a,c,d=t(r),u=i(s,d);u.length&&(a=o,c=l,window.fetch("/courses/ad-code?publicationType="+a+"&publicationId="+c,{method:"GET",credentials:"same-origin",headers:{Accept:"application/json","X-CSRF-TOKEN":window.csrfToken}}).then(function(e){return e.json()})).then(function(t){var i=[];e.each(u,function(s,o){(function(e,n,t){if(0===n.length)return!0;var i=n[n.length-1].nextElementSibling,s=i.offsetTop+i.offsetHeight;return e.offsetTop>s+t})(o,i,d.mixPixelsBetweenTwoAds)&&(function(t,i){i.after(t);var s=e(".js-schedule-period",t);e.each(s,function(t,i){var s=e(i).closest(".js-courseAdItem"),o=new Date(1e3*s.data("closeTimestamp")),l=s.find(".js-schedule-period");new n({dateEnd:o,onEnd:function(){s.hide()},onTick:function(e){var n,t,i,s,o;l.text((t=(n=e).days,i=n.hours,s=n.seconds,o=n.minutes,t>1?"in "+t+" "+(1===t?"day":"days"):i>1?"in "+i+" "+(1===i?"hr":"hrs")+" "+o+" "+(1===o?"min":"mins")+" "+s+" "+(1===s?"sec":"secs"):o>1?"in "+o+" "+(1===o?"min":"mins")+" "+s+" "+(1===s?"sec":"secs"):s>1?"in "+s+" "+(1===s?"sec":"secs"):"<span>Enrollment is closed</span>"))}})})}(e(t.html),e(o)),i.push(o))})})}}});
//# sourceMappingURL=courseAdInjector.js.map
